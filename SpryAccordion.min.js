"undefined"==typeof Spry&&(window.Spry={}),Spry.Widget||(Spry.Widget={}),Spry.Widget.Accordion=function(element,opts){this.element=this.getElement(element),this.defaultPanel=0,this.hoverClass="AccordionPanelTabHover",this.openClass="AccordionPanelOpen",this.closedClass="AccordionPanelClosed",this.focusedClass="AccordionFocused",this.enableAnimation=!0,this.enableKeyboardNavigation=!0,this.currentPanel=null,this.animator=null,this.hasFocus=null,this.previousPanelKeyCode=Spry.Widget.Accordion.KEY_UP,this.nextPanelKeyCode=Spry.Widget.Accordion.KEY_DOWN,this.useFixedPanelHeights=!0,this.fixedPanelHeight=0,Spry.Widget.Accordion.setOptions(this,opts,!0),this.element&&this.attachBehaviors()},Spry.Widget.Accordion.prototype.getElement=function(ele){return ele&&"string"==typeof ele?document.getElementById(ele):ele},Spry.Widget.Accordion.prototype.addClassName=function(ele,className){!ele||!className||ele.className&&-1!=ele.className.search(new RegExp("\\b"+className+"\\b"))||(ele.className+=(ele.className?" ":"")+className)},Spry.Widget.Accordion.prototype.removeClassName=function(ele,className){!ele||!className||ele.className&&-1==ele.className.search(new RegExp("\\b"+className+"\\b"))||(ele.className=ele.className.replace(new RegExp("\\s*\\b"+className+"\\b","g"),""))},Spry.Widget.Accordion.setOptions=function(obj,optionsObj,ignoreUndefinedProps){if(optionsObj)for(var optionName in optionsObj)ignoreUndefinedProps&&null==optionsObj[optionName]||(obj[optionName]=optionsObj[optionName])},Spry.Widget.Accordion.prototype.onPanelTabMouseOver=function(e,panel){return panel&&this.addClassName(this.getPanelTab(panel),this.hoverClass),!1},Spry.Widget.Accordion.prototype.onPanelTabMouseOut=function(e,panel){return panel&&this.removeClassName(this.getPanelTab(panel),this.hoverClass),!1},Spry.Widget.Accordion.prototype.openPanel=function(elementOrIndex){var panelA=this.currentPanel,panelB;if(!(panelB="number"==typeof elementOrIndex?this.getPanels()[elementOrIndex]:this.getElement(elementOrIndex))||panelA==panelB)return null;var contentA=panelA?this.getPanelContent(panelA):null,contentB=this.getPanelContent(panelB);return contentB?(this.useFixedPanelHeights&&!this.fixedPanelHeight&&(this.fixedPanelHeight=contentA.offsetHeight?contentA.offsetHeight:contentA.scrollHeight),this.enableAnimation?(this.animator&&this.animator.stop(),this.animator=new Spry.Widget.Accordion.PanelAnimator(this,panelB,{duration:this.duration,fps:this.fps,transition:this.transition}),this.animator.start()):(contentA&&(contentA.style.display="none",contentA.style.height="0px"),contentB.style.display="block",contentB.style.height=this.useFixedPanelHeights?this.fixedPanelHeight+"px":"auto"),panelA&&(this.removeClassName(panelA,this.openClass),this.addClassName(panelA,this.closedClass)),this.removeClassName(panelB,this.closedClass),this.addClassName(panelB,this.openClass),this.currentPanel=panelB,panelB):null},Spry.Widget.Accordion.prototype.closePanel=function(){if(!this.useFixedPanelHeights&&this.currentPanel){var panel=this.currentPanel,content=this.getPanelContent(panel);content&&(this.enableAnimation?(this.animator&&this.animator.stop(),this.animator=new Spry.Widget.Accordion.PanelAnimator(this,null,{duration:this.duration,fps:this.fps,transition:this.transition}),this.animator.start()):(content.style.display="none",content.style.height="0px")),this.removeClassName(panel,this.openClass),this.addClassName(panel,this.closedClass),this.currentPanel=null}},Spry.Widget.Accordion.prototype.openNextPanel=function(){return this.openPanel(this.getCurrentPanelIndex()+1)},Spry.Widget.Accordion.prototype.openPreviousPanel=function(){return this.openPanel(this.getCurrentPanelIndex()-1)},Spry.Widget.Accordion.prototype.openFirstPanel=function(){return this.openPanel(0)},Spry.Widget.Accordion.prototype.openLastPanel=function(){var panels=this.getPanels();return this.openPanel(panels[panels.length-1])},Spry.Widget.Accordion.prototype.onPanelTabClick=function(e,panel){return panel!=this.currentPanel?this.openPanel(panel):this.closePanel(),this.enableKeyboardNavigation&&this.focus(),e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1},Spry.Widget.Accordion.prototype.onFocus=function(e){return this.hasFocus=!0,this.addClassName(this.element,this.focusedClass),!1},Spry.Widget.Accordion.prototype.onBlur=function(e){return this.hasFocus=!1,this.removeClassName(this.element,this.focusedClass),!1},Spry.Widget.Accordion.KEY_UP=38,Spry.Widget.Accordion.KEY_DOWN=40,Spry.Widget.Accordion.prototype.onKeyDown=function(e){var key=e.keyCode;if(!this.hasFocus||key!=this.previousPanelKeyCode&&key!=this.nextPanelKeyCode)return!0;var panels=this.getPanels();if(!panels||panels.length<1)return!1;for(var currentPanel=this.currentPanel?this.currentPanel:panels[0],nextPanel=key==this.nextPanelKeyCode?currentPanel.nextSibling:currentPanel.previousSibling;nextPanel&&1!=nextPanel.nodeType;)nextPanel=key==this.nextPanelKeyCode?nextPanel.nextSibling:nextPanel.previousSibling;return nextPanel&&currentPanel!=nextPanel&&this.openPanel(nextPanel),e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,!1},Spry.Widget.Accordion.prototype.attachPanelHandlers=function(panel){if(panel){var tab=this.getPanelTab(panel);if(tab){var self=this;Spry.Widget.Accordion.addEventListener(tab,"click",(function(e){return self.onPanelTabClick(e,panel)}),!1),Spry.Widget.Accordion.addEventListener(tab,"mouseover",(function(e){return self.onPanelTabMouseOver(e,panel)}),!1),Spry.Widget.Accordion.addEventListener(tab,"mouseout",(function(e){return self.onPanelTabMouseOut(e,panel)}),!1)}}},Spry.Widget.Accordion.addEventListener=function(element,eventType,handler,capture){try{element.addEventListener?element.addEventListener(eventType,handler,capture):element.attachEvent&&element.attachEvent("on"+eventType,handler)}catch(e){}},Spry.Widget.Accordion.prototype.initPanel=function(panel,isDefault){var content=this.getPanelContent(panel);isDefault?(this.currentPanel=panel,this.removeClassName(panel,this.closedClass),this.addClassName(panel,this.openClass),content&&(this.useFixedPanelHeights?this.fixedPanelHeight&&(content.style.height=this.fixedPanelHeight+"px"):content.style.height="auto")):(this.removeClassName(panel,this.openClass),this.addClassName(panel,this.closedClass),content&&(content.style.height="0px",content.style.display="none")),this.attachPanelHandlers(panel)},Spry.Widget.Accordion.prototype.attachBehaviors=function(){for(var panels=this.getPanels(),i=0;i<panels.length;i++)this.initPanel(panels[i],i==this.defaultPanel);if(this.enableKeyboardNavigation=this.enableKeyboardNavigation&&this.element.attributes.getNamedItem("tabindex"),this.enableKeyboardNavigation){var self=this;Spry.Widget.Accordion.addEventListener(this.element,"focus",(function(e){return self.onFocus(e)}),!1),Spry.Widget.Accordion.addEventListener(this.element,"blur",(function(e){return self.onBlur(e)}),!1),Spry.Widget.Accordion.addEventListener(this.element,"keydown",(function(e){return self.onKeyDown(e)}),!1)}},Spry.Widget.Accordion.prototype.getPanels=function(){return this.getElementChildren(this.element)},Spry.Widget.Accordion.prototype.getCurrentPanel=function(){return this.currentPanel},Spry.Widget.Accordion.prototype.getPanelIndex=function(panel){for(var panels=this.getPanels(),i=0;i<panels.length;i++)if(panel==panels[i])return i;return-1},Spry.Widget.Accordion.prototype.getCurrentPanelIndex=function(){return this.getPanelIndex(this.currentPanel)},Spry.Widget.Accordion.prototype.getPanelTab=function(panel){return panel?this.getElementChildren(panel)[0]:null},Spry.Widget.Accordion.prototype.getPanelContent=function(panel){return panel?this.getElementChildren(panel)[1]:null},Spry.Widget.Accordion.prototype.getElementChildren=function(element){for(var children=[],child=element.firstChild;child;)1==child.nodeType&&children.push(child),child=child.nextSibling;return children},Spry.Widget.Accordion.prototype.focus=function(){this.element&&this.element.focus&&this.element.focus()},Spry.Widget.Accordion.prototype.blur=function(){this.element&&this.element.blur&&this.element.blur()},Spry.Widget.Accordion.PanelAnimator=function(accordion,panel,opts){this.timer=null,this.interval=0,this.fps=60,this.duration=500,this.startTime=0,this.transition=Spry.Widget.Accordion.PanelAnimator.defaultTransition,this.onComplete=null,this.panel=panel,this.panelToOpen=accordion.getElement(panel),this.panelData=[],this.useFixedPanelHeights=accordion.useFixedPanelHeights,Spry.Widget.Accordion.setOptions(this,opts,!0),this.interval=Math.floor(1e3/this.fps);for(var panels=accordion.getPanels(),i=0;i<panels.length;i++){var p=panels[i],c=accordion.getPanelContent(p);if(c){var h=c.offsetHeight;if(null==h&&(h=0),p==panel&&0==h&&(c.style.display="block"),p==panel||h>0){var obj=new Object;obj.panel=p,obj.content=c,obj.fromHeight=h,obj.toHeight=p==panel?accordion.useFixedPanelHeights?accordion.fixedPanelHeight:c.scrollHeight:0,obj.distance=obj.toHeight-obj.fromHeight,obj.overflow=c.style.overflow,this.panelData.push(obj),c.style.overflow="hidden",c.style.height=h+"px"}}}},Spry.Widget.Accordion.PanelAnimator.defaultTransition=function(time,begin,finish,duration){return begin+(2-(time/=duration))*time*finish},Spry.Widget.Accordion.PanelAnimator.prototype.start=function(){var self=this;this.startTime=(new Date).getTime(),this.timer=setTimeout((function(){self.stepAnimation()}),this.interval)},Spry.Widget.Accordion.PanelAnimator.prototype.stop=function(){if(this.timer)for(clearTimeout(this.timer),i=0;i<this.panelData.length;i++)obj=this.panelData[i],obj.content.style.overflow=obj.overflow;this.timer=null},Spry.Widget.Accordion.PanelAnimator.prototype.stepAnimation=function(){var curTime,elapsedTime=(new Date).getTime()-this.startTime,i,obj;if(elapsedTime>=this.duration){for(i=0;i<this.panelData.length;i++)(obj=this.panelData[i]).panel!=this.panel&&(obj.content.style.display="none",obj.content.style.height="0px"),obj.content.style.overflow=obj.overflow,obj.content.style.height=this.useFixedPanelHeights||0==obj.toHeight?obj.toHeight+"px":"auto";this.onComplete&&this.onComplete()}else{for(i=0;i<this.panelData.length;i++){obj=this.panelData[i];var ht=this.transition(elapsedTime,obj.fromHeight,obj.distance,this.duration);obj.content.style.height=(ht<0?0:ht)+"px"}var self=this;this.timer=setTimeout((function(){self.stepAnimation()}),this.interval)}};